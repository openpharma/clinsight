<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>App Configuration &amp; Input Data Specifications • clinsight</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="App Configuration &amp; Input Data Specifications">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clinsight</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Contributions.html">Contributions</a></li>
    <li><a class="dropdown-item" href="../articles/data_spec.html">App Configuration &amp; Input Data Specifications</a></li>
    <li><a class="dropdown-item" href="../articles/test_report.html">Test report</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/clinsight/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>App Configuration &amp; Input Data Specifications</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/clinsight/blob/v0.1.1/vignettes/data_spec.Rmd" class="external-link"><code>vignettes/data_spec.Rmd</code></a></small>
      <div class="d-none name"><code>data_spec.Rmd</code></div>
    </div>

    
    
<p>Note: this page is “under construction” until the
<code>clinsight</code> package developers create helper functions that
transform at least one other EDC data source into the desired format. In
the meantime, this page provides useful documentation to the existing
data specifications. Eventually, it will also share guidelines about how
to combine your input data with metadata sources, etc.</p>
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>In order to get started and plug your organizations EDC data into the
<code>clinsight</code> application, please notice this app is outfitted
with a <code>./inst/golem-config.yml</code> file to configure several
elements of deployment. Below is a typical configuration file:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">default</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="at">  </span><span class="fu">golem_name</span><span class="kw">:</span><span class="at"> clinsight</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="at">  </span><span class="fu">golem_version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.0.0.9004</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="at">  </span><span class="fu">app_prod</span><span class="kw">:</span><span class="at"> </span><span class="ch">no</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="at">  </span><span class="fu">user_identification</span><span class="kw">:</span><span class="at"> test_user</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="at">  </span><span class="fu">study_data</span><span class="kw">:</span><span class="at"> !expr clinsight::clinsightful_data</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="at">  </span><span class="fu">meta_data</span><span class="kw">:</span><span class="at"> !expr clinsight::metadata</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="at">  </span><span class="fu">user_db</span><span class="kw">:</span><span class="at"> user_db.sqlite</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="at">  </span><span class="fu">user_roles</span><span class="kw">:</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="at">   </span><span class="fu">Administrator</span><span class="kw">:</span><span class="at"> admin</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="at">   </span><span class="fu">Medical Monitor</span><span class="kw">:</span><span class="at"> medical_monitor</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="at">   </span><span class="fu">Data Manager</span><span class="kw">:</span><span class="at"> data_manager</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="fu">shinymanager</span><span class="kw">:</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="at">  </span><span class="fu">app_prod</span><span class="kw">:</span><span class="at"> </span><span class="ch">yes</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="at">  </span><span class="fu">user_identification</span><span class="kw">:</span><span class="at"> shinymanager</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="at">  </span><span class="fu">study_data</span><span class="kw">:</span><span class="at"> study_data.rds</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="at">  </span><span class="fu">meta_data</span><span class="kw">:</span><span class="at"> metadata.rds</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="at">  </span><span class="fu">credentials_db</span><span class="kw">:</span><span class="at"> credentials_db.sqlite</span></span></code></pre></div>
<p>First and foremost, notice that the configuration can vary depending
on deployment use case. For example, the above file is designed to run
(by default) with test data built into the app. Only once in
<code>production</code> mode, does the app actually leverage data you’ve
gathered from your EDC system, as RDS files. As seen above, there are
several other elements defined in <code>golem-config.yml</code> that can
be configured before launching the application for the first time.</p>
<p>The main two elements are <code>meta_data</code> and
<code>study_data</code>, accepting file paths to the app’s primary data
sources, stored as RDS files. The <code>study_data</code> object should
be created with the pre-processing helper function called
<code><a href="../reference/merge_meta_with_data.html">merge_meta_with_data()</a></code> which accepts raw data sources and
merges them with the <code>meta_data</code> object defined in this
article.</p>
<p>Other elements are:</p>
<ul>
<li>
<code>user_db</code> a Character string providing the path to the
app’s review database. If it does not exist, one will be created based
on the <code>study_data</code> and <code>meta_data</code>, with all data
labeled as new/not yet reviewed.</li>
<li>
<code>credentials_db</code> Character string. Path to the
credentials database. Only needed when using <code>shinymanager</code>
for user identification. The database will be created automatically if
needed.</li>
</ul>
<p>Depending on the EDC vendor used, the size, shape, and format of
their “raw data” may vary. We’ve compiled a few functions that help
admin users pre-process the data they own. However, before we deep dive
into how to use those, let’s focus on what the final result of those
pre-processing steps to understand what’s being fed to the app.</p>
</div>
<div class="section level2">
<h2 id="data-specifications">Data Specifications<a class="anchor" aria-label="anchor" href="#data-specifications"></a>
</h2>
<p>Baked into the <code>clinsight</code> package is an internal
data.frame called <code>clinsightful_data</code>, which is comprised of
randomly generated test data for this application. Here is a preview of
that data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run to load the data into an R session. </span></span>
<span><span class="co"># pkg_name &lt;- "clinsight"</span></span>
<span><span class="co"># library(pkg_name, character.only = TRUE)</span></span>
<span><span class="co"># data("clinsightful_data") </span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">clinsight</span><span class="fu">::</span><span class="va"><a href="../reference/clinsightful_data.html">clinsightful_data</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 24</span></span></span>
<span><span class="co">#&gt;   site_code subject_id event_repeat event_id event_name event_date form_id</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Site 08   BEL_08_885            1 SCR      Screening  2023-06-05 LBHM   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Site 08   BEL_08_885            1 SCR      Screening  2023-06-05 LBHM   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Site 08   BEL_08_885            1 SCR      Screening  2023-06-05 LBHM   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Site 08   BEL_08_885            1 SCR      Screening  2023-06-05 LBHM   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Site 08   BEL_08_885            1 SCR      Screening  2023-06-05 LBHM   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Site 08   BEL_08_885            1 SCR      Screening  2023-06-05 LBHM   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 17 more variables: form_repeat &lt;int&gt;, edit_date_time &lt;dttm&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   db_update_time &lt;dttm&gt;, region &lt;chr&gt;, day &lt;drtn&gt;, vis_day &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   vis_num &lt;dbl&gt;, event_label &lt;chr&gt;, item_name &lt;chr&gt;, item_type &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   item_group &lt;chr&gt;, item_value &lt;chr&gt;, item_unit &lt;chr&gt;, lower_lim &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   upper_lim &lt;dbl&gt;, significance &lt;chr&gt;, reason_notdone &lt;chr&gt;</span></span></span></code></pre></div>
<p>This object is an example of a healthy <code>study_data</code>
object, that should preferably be stored as an RDS file prior to
launching the app. let’s inspect it a little more:</p>
<div class="section level3">
<h3 id="study_data">
<code>study_data</code><a class="anchor" aria-label="anchor" href="#study_data"></a>
</h3>
<p>The RDS file (or data.frame) ported to the <code>study_data</code>
element contains the following required columns below.</p>
<ul>
<li>
<code>site_code</code>: character or integer, identifier for study
site; If an integer, recommended to add prefix “Site” as this will
display more intuitively in the application’s UI</li>
<li>
<code>subject_id</code>: character, unique identifier for a
subject</li>
<li>
<code>event_repeat</code>: integer, helps keep track of unique
<code>event_id</code> for a single <code>subject_id</code> and
<code>event_date</code>
</li>
<li>
<code>event_id</code>: character, names that help classify types of
<code>event_name</code>s into like-groups, generally characterized by
site visits. For example, “SCR” for the screening visit, “VIS” for Visit
X (where X is some integer), and “EXIT” for when the patient exits the
study trial. However, some <code>event_id</code>s track events that
could apply outside of any visit, like AE, ConMed, Medical History,
etc.</li>
<li>
<code>event_name</code>: character, an “event” generally
characterizes some sort of site visit, whether that be a “Screening”,
“Visit X” (where X is some integer), “Exit”, or “Any Visit”.</li>
<li>
<code>event_date</code>: Date, the date associated with
<code>event_name</code>
</li>
<li>
<code>form_id</code>: character, a unique identifier for the form
the <code>item_name</code> metric and <code>item_value</code> were
pulled from. Note: when <code>item_type</code> is continuous,
<code>form_id</code> can contain several different
<code>item_group</code>s. However, when <code>item_type</code> is
‘other’, <code>item_group</code> can be made up of several
<code>form_id</code> values.</li>
<li>
<code>form_repeat</code>: integer, helps keep track of unique
<code>item_name</code>s collected from a specific <code>form_id</code>
for a given <code>subject_id</code>. <code>form_repeat</code> is
particularly helpful when consolidating data like Adverse Events into
this data format. Specifically, if more than one AE is collected on a
patient, they’ll have more than one <code>form_repeat</code>
</li>
<li>
<code>edit_date_time</code>: datetime (POSIXct), the last time this
record was edited</li>
<li>
<code>db_update_time</code>: datetime (POSIXct), the last time the
database storing this record was updated.</li>
<li>
<code>region</code>: character, describing the region code that
<code>site_code</code> falls under</li>
<li>
<code>day</code>: a difftime number, meaning it contains both a
number and unit of time. It measures the number of days each visit is
from screening</li>
<li>
<code>vis_day</code>: numeric, a numeric representation of
<code>day</code>
</li>
<li>
<code>vis_num</code>: numeric, a numeric representation of
<code>event_name</code>
</li>
<li>
<code>event_label</code>: character, an abbreviation of
<code>event_name</code>
</li>
<li>
<code>item_name</code>: character, describes a metric or parameter
of interest.</li>
<li>
<code>item_type</code>: character, classifies
<code>item_name</code>s into either ‘continuous’ or ‘other’, where
continuous types are those generally associated with the CDISC “basic
data structure” (BDS). That is, each <code>item_name</code> metric is
collected over time at a patient visit (<code>event_name</code>). The
‘other’ type represents all non-time dependent measures, like
demographic info, adverse events, Medications, medical history,
etc.</li>
<li>
<code>item_group</code>: character, provides is a high level
category that groups like-<code>item_name</code>s together. For example,
and <code>item_group</code> = ‘Vital Signs’ will group together
pertinent <code>item_name</code> metrics like BMI, Pulse, Blood
pressure, etc.</li>
<li>
<code>item_value</code>: character, the measurement collected for a
given <code>item_name</code>. The value collected may be a number like
150 (when collecting a patient’s weight) or a word (such as ‘white’ for
the subject’s race).</li>
<li>
<code>item_unit</code>: character, tracking the unit of measurement
for <code>item_name</code> and <code>item_value</code>.</li>
<li>
<code>lower_lim</code>: numeric, some <code>item_name</code>s
(particularly the ‘continuous’ type) have a pre-defined range of values
that are considered normal. This is the lower limit to that range.</li>
<li>
<code>upper_lim</code>: numeric, some <code>item_name</code>s
(particularly the ‘continuous’ type) have a pre-defined range of values
that are considered normal. This is the upper limit to that range.</li>
<li>
<code>significance</code>: character, either ‘CS’ which means
‘Clinically Significant’ or ‘NCS’ which means ‘Not Clinically
Significant’</li>
<li>
<code>reason_notdone</code>: character, an effort to describe why
the <code>item_value</code> field is <code>NA</code> / missing.</li>
</ul>
</div>
<div class="section level3">
<h3 id="processing-your-raw-data">Processing your Raw Data<a class="anchor" aria-label="anchor" href="#processing-your-raw-data"></a>
</h3>
<p>So, the next logical question is “How do I get my EDC’s data into the
<code>study_data</code> format?” Well, this package currently offers a
pre-processing helper function called
<code><a href="../reference/merge_meta_with_data.html">merge_meta_with_data()</a></code> which accepts raw data sources from
the [Viedoc] EDC vendor and merges them with the <code>meta_data</code>
object (defined below) to create a viable <code>study_data</code>
object. As such, we’ll spend some time covering what this helper
function expects of your raw data and <code>meta_data</code> object and
how it transforms it into the <code>study_data</code> object we need for
app launch.</p>
<p>First, let’s discuss the app’s metadata needs!</p>
</div>
<div class="section level3">
<h3 id="meta_data">
<code>meta_data</code><a class="anchor" aria-label="anchor" href="#meta_data"></a>
</h3>
<p>The <code>meta_data</code> object is a list of data.frames which (not
surprisingly) contains metadata information for the application. It will
provide study-specific settings, and controls where study data in the
application will be visible. It can be created in the right format by
changing the Excel template in the <code>data-raw/metadata.xlsx</code>,
and then create a metadata object with the
function<code>get_metadata</code>
(e.g. <code>meta &lt;- clinsight::get_metadata("path-to-custom-metadata.xlsx")</code>).
The <code>meta_data</code> object should be saved as a <code>.rds</code>
file so that <code>clinsight</code> can use it
(e.g. <code>saveRDS(meta, "data_folder/metadata.rds")</code>).</p>
<p>As stated previously, the metadata should also be used to shape the
raw <code>study_data</code> in the right format, and to dictate which
variables will be included in the <code>study_data</code>. This can be
done by using the function <code><a href="../reference/merge_meta_with_data.html">merge_meta_with_data()</a></code>, and will
be described in detail in the next section. The goal is that most, if
not all study-specific data will be captured in the metadata, leaving
the scripts to run the application largely unaltered between
studies.</p>
<p>Just like for <code>study_data</code>, this package also bundles a
built-in metadata object called <code>metadata</code>. To view an
example metadata file, run the following chunk of code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">meta_data</span> <span class="op">&lt;-</span> <span class="fu">clinsight</span><span class="fu">::</span><span class="va"><a href="../reference/metadata.html">metadata</a></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">meta_data</span>, <span class="va">head</span><span class="op">)</span></span>
<span><span class="co">#&gt; $column_names</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   name_raw  name_new    </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> SiteCode  site_code   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> SubjectId subject_id  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> EventId   event_id    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> EventDate event_date  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> EventName event_name  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> EventSeq  event_repeat</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $events</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   event_number event_name event_label</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0            Screening  V0         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1            Visit 1    V1         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2            Visit 2    V2         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 3            Visit 3    V3         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 4            Visit 4    V4         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 5            Visit 5    V5         </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $common_forms</span></span>
<span><span class="co">#&gt;              item_name item_type     item_group</span></span>
<span><span class="co">#&gt; 1            AE Number     other Adverse events</span></span>
<span><span class="co">#&gt; 2              AE Name     other Adverse events</span></span>
<span><span class="co">#&gt; 3                 AESI     other Adverse events</span></span>
<span><span class="co">#&gt; 4        AE start date     other Adverse events</span></span>
<span><span class="co">#&gt; 5          AE end date     other Adverse events</span></span>
<span><span class="co">#&gt; 6 AE date of worsening     other Adverse events</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $study_forms</span></span>
<span><span class="co">#&gt;                       item_name  item_type  item_group        unit lower_limit</span></span>
<span><span class="co">#&gt; 1       Systolic blood pressure continuous Vital signs        mmHg          90</span></span>
<span><span class="co">#&gt; 2      Diastolic blood pressure continuous Vital signs        mmHg          55</span></span>
<span><span class="co">#&gt; 3                         Pulse continuous Vital signs   beats/min          60</span></span>
<span><span class="co">#&gt; 4                          Resp continuous Vital signs breaths/min          12</span></span>
<span><span class="co">#&gt; 5                   Temperature continuous Vital signs          °C          35</span></span>
<span><span class="co">#&gt; 6 Weight change since screening continuous Vital signs        &lt;NA&gt;        &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   upper_limit</span></span>
<span><span class="co">#&gt; 1         160</span></span>
<span><span class="co">#&gt; 2          90</span></span>
<span><span class="co">#&gt; 3         100</span></span>
<span><span class="co">#&gt; 4          20</span></span>
<span><span class="co">#&gt; 5        38.5</span></span>
<span><span class="co">#&gt; 6        &lt;NA&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $general</span></span>
<span><span class="co">#&gt;            item_name item_type item_group</span></span>
<span><span class="co">#&gt; 1                Age     other    General</span></span>
<span><span class="co">#&gt; 2                Sex     other    General</span></span>
<span><span class="co">#&gt; 3               ECOG     other    General</span></span>
<span><span class="co">#&gt; 4           Eligible     other    General</span></span>
<span><span class="co">#&gt; 5      Eligible_Date     other    General</span></span>
<span><span class="co">#&gt; 6 WHO.classification     other    General</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $form_level_data</span></span>
<span><span class="co">#&gt;         item_group item_scale use_unscaled_limits review_required</span></span>
<span><span class="co">#&gt; 1   Adverse events         NA                  NA            TRUE</span></span>
<span><span class="co">#&gt; 2       Medication         NA                  NA            TRUE</span></span>
<span><span class="co">#&gt; 3 Conc. Procedures         NA                  NA            TRUE</span></span>
<span><span class="co">#&gt; 4  Medical History         NA                  NA            TRUE</span></span>
<span><span class="co">#&gt; 5      Vital signs      FALSE                TRUE            TRUE</span></span>
<span><span class="co">#&gt; 6     Electrolytes       TRUE               FALSE            TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $table_names</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   table_name raw_name      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Edit date  edit_date_time</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Date       event_date    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Event      event_label   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Event      event_name    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> eN         event_repeat  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Form       item_group    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $items_expanded</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt;   var        suffix item_name item_type item_group unit  lower_limit upper_limit</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AE_AESPID  <span style="color: #BB0000;">NA</span>     AE Number other     Adverse e… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AE_AETERM  <span style="color: #BB0000;">NA</span>     AE Name   other     Adverse e… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> AE_AESI    <span style="color: #BB0000;">NA</span>     AESI      other     Adverse e… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> AE_AESTDAT <span style="color: #BB0000;">NA</span>     AE start… other     Adverse e… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> AE_AEENDAT <span style="color: #BB0000;">NA</span>     AE end d… other     Adverse e… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> AE_AESTDA… <span style="color: #BB0000;">NA</span>     AE date … other     Adverse e… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>Specifications for the list of data.frames include:</p>
<ul>
<li>
<p><code>column_names</code>: Used to map raw data variable names
over to new names.</p>
<ul>
<li>
<code>name_raw</code>: character, variable name in the raw data
source</li>
<li>
<code>name_new</code>: character, desired variable name to use in
<code>study_data</code> and in the application</li>
</ul>
</li>
<li>
<p><code>events</code>: Used to create a simple timeline in the
application, with predefined number of planned visits, N. It contains
the following columns:</p>
<ul>
<li>
<code>event_number</code>: integer. Example: 0, 1, 2, …, N</li>
<li>
<code>event_name</code>: character. Example: “Screening”, “Visit 1”,
“Visit 2”, …, “Visit N”</li>
<li>
<code>event_label</code>: character. Example: “V0”, “V1”, “V2”, …,
“VN”</li>
</ul>
</li>
<li>
<p><code>common_forms</code>: Used to select and rename the
variables of interest in the raw data when transformed into the desired
<code>study_data</code> format. Note: creating the
<code>study_data</code> data.frame should use
<code><a href="../reference/merge_meta_with_data.html">merge_meta_with_data()</a></code> where (not surprisingly), the
metadata is merged with the raw study data. <code>common_forms</code>
contains the columns below:</p>
<ul>
<li>
<code>var</code>: character, the variable name to display in the
table, mapped from a known <code>item_name</code> provided in
<code>study_data</code>. Example: <code>item_name = "AE Name"</code>
will be replaced by “AE_AETERM” when
<code>var = "AE_AETERM"</code>.</li>
<li>
<code>suffix</code>: Usually blank in this data.frame. This column
is more commonly used in the <code>study_forms</code> data.frame</li>
<li>
<code>item_name</code>: character, known <code>item_name</code>s
found in <code>study_data</code>. There are certain
<code>item_name</code>s that are required, even if missing in
<code>study_data</code>, including: “AE Name”, “AE start date”, “AE end
date”, “AE date of worsening”, “AE CTCAE severity”, “AE CTCAE severity
worsening”, “Serious Adverse Event”, and “SAE Start date”.</li>
<li>
<code>item_type</code>: character, known <code>item_type</code>
corresponding to those found for <code>item_name</code>s in
<code>study_data</code>.</li>
<li>
<code>item_group</code>: character, known <code>item_group</code>
corresponding to those found for <code>item_name</code>s in
<code>study_data</code>.</li>
</ul>
</li>
<li>
<p><code>study_forms</code>: Contains the same columns as the
data.frame <code>common_forms</code>, and in addition the columns
<code>unit</code>, <code>lower_limit</code>, <code>upper_limit</code>.
Used to select and rename the raw data variables of interest. In
addition, the <code>suffix</code> column is used more regularly in this
“study” context. This is because, these variable names may have a
consistent trunk / stem, with varying suffixes to describe a similar
style measurement. So instead of creating a new row for these variables
in the <code>meta_data</code> data.frame, we allow for inclusion of
several suffixes. For example, VS_PULSE measures beats/min. Typically,
these measures are collected using VS_PULSE_VSORRES &amp;
VS_PULSE_VSREAND, but in this format, we can list the stem “VS_PULSE” as
the <code>var</code> and <code>"VSORRES, VSREAND"</code> in the suffix
field. As for the new columns, they are defined as follows:</p>
<ul>
<li>
<code>unit</code>: character, unit of measure</li>
<li>
<code>lower_limit</code>: numeric, the lower limit of what’s
considered clinically significant</li>
<li>
<code>upper_limit</code>: numeric, the upper limit of what’s
considered clinically significant</li>
</ul>
</li>
<li><p><code>general</code>: Contains the same columns as
<code>common_forms</code> and is used in the same way. That is, it’s
used to select and rename the raw data when transformed into the desired
<code>study_data</code> format. Note: creating the
<code>study_data</code> data.frame should use
<code><a href="../reference/merge_meta_with_data.html">merge_meta_with_data()</a></code> where (not surprisingly), the
metadata is merged with the raw study data. Please refer to the
<code>common_forms</code> spec above. However, I will note that there
are certain <code>item_name</code>s that are required, even if missing
in <code>study_data</code>, including: “Age”, “Sex”, “ECOG”, “Eligible”,
“WHO.classification”, “DiscontinuationReason”, “DrugAdminDate”, and
“DrugAdminDose”.</p></li>
<li><p><code>groups</code>: Contains the columns
<code>item_group</code>, <code>item_type</code>,
<code>item_scale</code>,<code>use_unscaled_limits</code>.</p></li>
<li>
<p><code>table_names</code>: Used for renaming table column names
into a more readable format. It is not required to name all column
names; if the column names are not defined here, the raw name will be
used instead.</p>
<ul>
<li>
<code>table_name</code>: character,</li>
<li>
<code>raw_name</code>: character,</li>
</ul>
</li>
</ul>
<div class="section level4">
<h4 id="get_metadata-items_expanded">
<code>get_metadata()</code> &amp; <code>items_expanded</code><a class="anchor" aria-label="anchor" href="#get_metadata-items_expanded"></a>
</h4>
<p>So, lastly, you may notice that there is a 7th data.frame called
<code>items_expanded</code>. This data.frame is actually derived after
the user runs a helper function called <code><a href="../reference/get_metadata.html">get_metadata()</a></code> which
takes an XLSX file containing the first 6 data.frames (one per tab) and
expands the tabs of your choosing with the column of your choosing. In
other words, <code><a href="../reference/get_metadata.html">get_metadata()</a></code> makes sure your existing
metadata is in the correct format and helps us get create something a
bit more polished &amp; digestible, like <code>items_expanded</code> for
<code><a href="../reference/metadata.html">clinsight::metadata</a></code>. As you’ll see later, performing this
step is crucial for <code><a href="../reference/merge_meta_with_data.html">merge_meta_with_data()</a></code> which comes
next. So, after you’ve compiled your metadata XLSX spreadsheet with the
first 6 data.frames (tabs) mentioned above, you’re ready to run code
that looks like the following:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># usethis::edit_r_environ()</span></span>
<span><span class="va">meta_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"METADATA_PATH"</span><span class="op">)</span></span>
<span><span class="va">meta_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_metadata.html">get_metadata</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">meta_path</span>, <span class="st">"my_metadata.xlsx"</span><span class="op">)</span>,</span>
<span>                          expand_tab_items <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"common_forms"</span>, <span class="st">"study_forms"</span>, <span class="st">"general"</span><span class="op">)</span>,</span>
<span>                          expand_cols <span class="op">=</span> <span class="st">"suffix"</span><span class="op">)</span></span></code></pre></div>
<p>In summary, <code>get_metadata</code> will initiate the
<code>meta_data</code> object with the first 6 data.frames directly from
the Excel file, and then <code>items_expanded</code> will be created by
expanding <code>common_forms</code>, <code>study_forms</code>, and
<code>general</code> data.frames by the values stored in the
<code>suffix</code> column. The result will be appended onto the
<code>meta_data</code> object as the 7th data.frame in the list.</p>
<p>Once complete, save your metadata to an .RDS file:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">meta_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"METADATA_PATH"</span><span class="op">)</span>, <span class="st">"meta_data.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="read-in-your-study-data-with-get_raw_csv_data">Read in your study data with <code>get_raw_csv_data()</code><a class="anchor" aria-label="anchor" href="#read-in-your-study-data-with-get_raw_csv_data"></a>
</h3>
<p>Now that we have an understanding of our <code>meta_data</code>
specs, we can discuss how they interact with your raw data. The rest of
this vignette will feel more like an R script as we discuss how this
happens. First, we need to read in our raw data. There is yet another
helper function bundled in this package called
<code><a href="../reference/get_raw_csv_data.html">get_raw_csv_data()</a></code> to help us do that. It’s a pretty simple
wrapper function that basically reads in raw data files stored as CSVs
from a designated folder. As such, your function call should look
something like the following code chunk. Notice, you can either set your
raw data path explicitly, or in your <code>.Renviron</code> file.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># usethis::edit_r_environ()</span></span>
<span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"DATA_PATH"</span><span class="op">)</span></span>
<span><span class="va">raw_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_raw_csv_data.html">get_raw_csv_data</a></span><span class="op">(</span><span class="va">data_path</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="finish-the-job-with-merge_meta_with_data">Finish the job with <code>merge_meta_with_data()</code><a class="anchor" aria-label="anchor" href="#finish-the-job-with-merge_meta_with_data"></a>
</h3>
<p>Now that our data has been read in and minimally cleaned up, we can
finally use the <code><a href="../reference/merge_meta_with_data.html">merge_meta_with_data()</a></code> function as shown
below:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">study_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_meta_with_data.html">merge_meta_with_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">raw_data</span>, meta <span class="op">=</span> <span class="va">meta_data</span><span class="op">)</span></span></code></pre></div>
<p>This function uses the rest of the metadata data.frames to further
organize your raw data into something usable by the app, including but
not limited to the following:</p>
<ul>
<li>renaming columns to the required column names needed in the
application
<ul>
<li>it will use the column provided in the metadata tab
<code>column_names</code>, and will verify if the new names still match
with the expected/required names. Notice that all of these variables are
required, so it’s important that you identify which variables from your
EDC mirror them.</li>
</ul>
</li>
<li>converting columns to the required column type (e.g. dates,
character, integer)</li>
<li>fixing multiple choice variables using a function called
<code><a href="../reference/fix_multiple_choice_vars.html">fix_multiple_choice_vars()</a></code>
</li>
<li>adding derivative values and columns such as:
<ul>
<li>
<code>vis_day</code> and <code>vis_num</code>, <code>day</code>
(variables based on <code>event_id</code> and
<code>event_date</code>).</li>
</ul>
</li>
<li>
<code>event_name</code> &amp; <code>event_label</code> have some
clean up performed on it’s values to standardize them for presentation
in the app. Last, the data is ordered by <code>site_code</code> and
<code>subject_id</code>
</li>
<li>merging the raw data with <code>meta_data$items_expanded</code>
</li>
<li>
</li>
<li>applying any study specific fixes using a function called
<code>apply_study_specfific_fixes()</code>. #TODO</li>
</ul>
<p>Once complete, save your metadata to an .RDS file:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">study_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"DATA_PATH"</span><span class="op">)</span>, <span class="st">"study_data.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="launch-the-app">Launch the app<a class="anchor" aria-label="anchor" href="#launch-the-app"></a>
</h2>
<p>Circling back to the configuration file we shared at the beginning of
this vignette, you’re now ready to launch this application.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">default</span><span class="kw">:</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="at">  </span><span class="fu">golem_name</span><span class="kw">:</span><span class="at"> clinsight</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="at">  </span><span class="fu">golem_version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.0.0.9004</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="at">  </span><span class="fu">app_prod</span><span class="kw">:</span><span class="at"> </span><span class="ch">no</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="at">  </span><span class="fu">user_identification</span><span class="kw">:</span><span class="at"> test_user</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="at">  </span><span class="fu">study_data</span><span class="kw">:</span><span class="at"> !expr clinsight::clinsightful_data</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="at">  </span><span class="fu">meta_data</span><span class="kw">:</span><span class="at"> !expr clinsight::metadata</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="at">  </span><span class="fu">user_db</span><span class="kw">:</span><span class="at"> user_db.sqlite</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="at">  </span><span class="fu">user_roles</span><span class="kw">:</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="at">   </span><span class="fu">Administrator</span><span class="kw">:</span><span class="at"> admin</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="at">   </span><span class="fu">Medical Monitor</span><span class="kw">:</span><span class="at"> medical_monitor</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="at">   </span><span class="fu">Data Manager</span><span class="kw">:</span><span class="at"> data_manager</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="fu">shinymanager</span><span class="kw">:</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="at">  </span><span class="fu">app_prod</span><span class="kw">:</span><span class="at"> </span><span class="ch">yes</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="at">  </span><span class="fu">user_identification</span><span class="kw">:</span><span class="at"> shinymanager</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="at">  </span><span class="fu">study_data</span><span class="kw">:</span><span class="at"> study_data.rds</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="at">  </span><span class="fu">meta_data</span><span class="kw">:</span><span class="at"> metadata.rds</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="at">  </span><span class="fu">credentials_db</span><span class="kw">:</span><span class="at"> credentials_db.sqlite</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leonard Daniël Samson, GCP-Service International Ltd.&amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
