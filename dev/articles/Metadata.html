<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Metadata • clinsight</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Metadata">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clinsight</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.0.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/clinsight.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Metadata.html">Metadata</a></li>
    <li><a class="dropdown-item" href="../articles/Deployment.html">Deployment</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Validation</h6></li>
    <li><a class="dropdown-item" href="../articles/test_report.html">Test report</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developer Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/Contributions.html">Contributions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/clinsight/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Metadata</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/clinsight/blob/dev/vignettes/Metadata.Rmd" class="external-link"><code>vignettes/Metadata.Rmd</code></a></small>
      <div class="d-none name"><code>Metadata.Rmd</code></div>
    </div>

    
    
<p>A metadata file needs to be customized and created for each study.
Use the function <code><a href="../reference/create_clinsight_metadata.html">create_clinsight_metadata()</a></code> to create and
open a new template. The Excel template contains multiple tabs which are
described below in detail. The orange tabs are mandatory and should not
be removed or renamed.</p>
<p><img src="images/metadata-tabs.png" width="587" height="35"></p>
<div class="section level4">
<h4 id="column_names">column_names<a class="anchor" aria-label="anchor" href="#column_names"></a>
</h4>
<p>Within the first tab, the column names of the raw data need to be
specified. The columns with the names within <code>name_raw</code> will
be renamed to the new name when merging metadata with raw data later.
Again, orange fields should not be adjusted.</p>
<p><img src="images/metadata-column_names.png"></p>
</div>
<div class="section level4">
<h4 id="events">events<a class="anchor" aria-label="anchor" href="#events"></a>
</h4>
<p>Next tab contains information about study events.</p>
<p><img src="images/metadata-events.png"></p>
<p>All study visits should be entered in the <code>event_id</code>
column, in order to preserve the correct order of events.</p>
<p>The green-colored column names are optional columns.
<code>is_regular_visit</code> can be used to mark a specific visit as
non-regular/ not planned. Unplanned visits will not show up in the
compact timeline and will not be used to increment an internal visit
counter for each patient.</p>
<p>If needed, the name of the <code>event_id</code> can be customized
using two columns. <code>event_label_custom</code> changes the event
label within the compact timeline in the top right corner of the
application. <code>event_name_custom</code> will change the standard
<code>event_id</code> label anywhere else in the application.</p>
<p>Lastly, ClinSight needs to know which is the baseline event to create
internal counters of how many days are passed since baseline. It assumes
that the first visit in the list (which is <code>SCR</code> in the
example) is the baseline visit, but this can be changed using the
<code>is_baseline_event</code> column. Note that only one event can be
set as baseline here.</p>
<p>If the number of events cannot be specified correctly beforehand, a
user can also provide an <code>event_id_pattern</code> matching to
create event labels and event names.</p>
</div>
<div class="section level4">
<h4 id="common_forms">common_forms<a class="anchor" aria-label="anchor" href="#common_forms"></a>
</h4>
<p>This tab contains information about the variables that need to be
displayed in the <code>Common events</code> tab in
<code>ClinSight</code>. Together with <code>study_forms</code> and
<code>general</code>, this tab contains most of the data that will be
shown in the app.</p>
<p>The column <code>var</code> contains the exact name of the variable
in the raw data. The <code>item_name</code> column contains the name of
the variable that will appear in the application. For common forms,
there are some prefixes that will be stripped from the
<code>item_name</code> so that a unique name for each variable can be
provided: (<code>AE</code> for <code>Adverse Events</code>
<code>CM</code> for (Concomitant) <code>Medication</code>, and
<code>MH</code> for <code>Medical History</code>). The
<code>item_group</code> column contains name of the form in which the
item will show up in the application. Lastly, <code>item_type</code> can
either be continuous or other, and it controls whether visualization or
only tables will be displayed. This should usually be set to
<code>other</code> within study_forms. More information on the other
implemented options follows in the description for the
<code>study_forms</code> below.</p>
<p><img src="images/metadata-common_forms.png" width="633"></p>
<p>Note that some of the <code>item_name</code>s are colored orange,
meaning that ClinSight expect these names to be present. Currently it is
not recommended to change these names. If they are missing in your own
data, just leave them in the metadata as is. It will be made easier to
customize these names and variables in a future update.</p>
</div>
<div class="section level4">
<h4 id="metadata-study_forms">study_forms<a class="anchor" aria-label="anchor" href="#metadata-study_forms"></a>
</h4>
<p>This tab contains information about the variables in the
<code>Study data</code> tab in ClinSight. Mandatory columns are here
<code>var</code>, <code>item_name</code>, <code>item_type</code>, and
<code>item_group</code>.</p>
<p><img src="images/metadata-study_forms.png"></p>
<p>Data and forms/item_groups entered in the <code>study_forms</code>
tab will either show up in table form or, if all variables within an
<code>item_group</code> are of <code>item_type</code> ‘continuous’, in
interactive graphs. If all data is ‘continuous’, units and limits can be
provided directly if these do not change within each site.</p>
</div>
<div class="section level4">
<h4 id="scale-continuous-values">Scale continuous values<a class="anchor" aria-label="anchor" href="#scale-continuous-values"></a>
</h4>
<p>If limits are provided in the data, and especially if they can vary
per study site, then there is an option within ClinSight to scale the
values for each variable to a value between 0 and 1, with 0 being the
lower limit and 1 being the upper limit of the normal range, based on
the normal ranges of the local laboratory. This way, the values of a
patient can be compared with all available data, even if other data was
provided with other laboratory data and units. The formula used for
scaling is shown below:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>x</mi><mo>−</mo><msub><mi>x</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mi>e</mi><mi>r</mi></mrow></msub></mrow><mrow><msub><mi>x</mi><mrow><mi>u</mi><mi>p</mi><mi>p</mi><mi>e</mi><mi>r</mi></mrow></msub><mo>−</mo><msub><mi>x</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mi>e</mi><mi>r</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">x_{scaled} = \frac{x-x_{lower}}{x_{upper}-x_{lower}}</annotation></semantics></math><em>(</em><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>x</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mi>e</mi><mi>r</mi></mrow></msup><annotation encoding="application/x-tex">x^{lower}</annotation></semantics></math>
is the lower limit of x and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>x</mi><mrow><mi>u</mi><mi>p</mi><mi>p</mi><mi>e</mi><mi>r</mi></mrow></msup><annotation encoding="application/x-tex">x^{upper}</annotation></semantics></math>
the upper limit, according to the site-specific laboratory ranges).</p>
<p>In order to use this functionality, first the value
<code>item_scale</code> in the tab <a href="#form_level_data">form_level_data</a> should be set to
<code>TRUE</code> and <code>use_unscaled_limits</code> to
<code>FALSE</code>, so that it is clear for the application that values
need to be scaled.</p>
<p>Then, additional data per variable needs to be provided. As an
example, we will highlight the settings for the ‘Sodium’ variable in the
package data. Multiple variables and values should be provided, with a
consistent base name that identifies that variable in question (in this
case <code>LBSER_SODIUM</code>, which corresponds to the
<code>Sodium</code> <code>item_name</code>, and a varying
<code>suffix</code>. For <code>Sodium</code>, the following variables
can or will be used by ClinSight and should be available in the data in
a long format, in the <code>var</code> column:</p>
<ul>
<li>
<code>LBSER_SODIUM_LBORRES</code>: The actual (raw) value belonging
to this variable.</li>
<li>
<code>LBSER_SODIUM_LBORNR_Lower</code>: The lower limit of the
normal range.</li>
<li>
<code>LBSER_SODIUM_LBORNR_Upper</code>: The upper limit of the
normal range.</li>
<li>
<code>LBSER_SODIUM_LBORRESU</code>: The unit belonging to the
variable</li>
<li>
<code>LBSER_SODIUM_LBORRESUOTH</code>: (Optional): If no standard
unit is provided, but the site enters the unit manually, in some EDCs
this input is in a separate row in the data. If provided here, this
value will be used as unit if unit information in
<code>LBSER_SODIUM_LBORRESU</code> is missing.</li>
<li>
<code>LBSER_SODIUM_LBCLSIG</code>: (Optional): Whether the value was
flagged as clinically significant (CS) or not clinically significant
(NCS).</li>
<li>
<code>LBSER_SODIUM_LBREASND</code>: (Optional): reason provided by
the site why a variable was not measured.</li>
</ul>
<p>To keep the metadata compact, the variables can also be provided by
only stating the base name <code>LBSER_SODIUM</code> in the
<code>var</code> column, and specifying the suffixes in the
<code>suffix</code> column (see screenshot above).
<code>ClinSight</code> will automatically expand the base name with all
suffixes provided when reading metadata with
<code><a href="../reference/get_metadata.html">get_metadata()</a></code>.</p>
<blockquote>
<p><em>Important note: while the base name is flexible, the suffix names
are not. It is easiest to keep the suffixes as stated above, since that
is the format that ClinSight expects: <code>LBORRES</code>,
<code>LBORNR_Lower</code>, <code>LBORNR_Upper</code>,
<code>LBORRESU</code>, <code>LBORRESUOTH</code>, <code>LBCLSIG</code>,
and <code>LBREASND</code>. If the <code>suffix</code> names differ in
the raw data, you can provide the actual names in the metadata tab, and
then provide a custom function in the <code>settings</code> tab (see
below) which renames the variables to the ones mentioned.</em></p>
</blockquote>
</div>
<div class="section level4">
<h4 id="general">general<a class="anchor" aria-label="anchor" href="#general"></a>
</h4>
<p>This tab contains information about variables that are needed in
ClinSight, but do not necessarily need to be displayed in the
<code>Common events</code> or <code>Study data</code> tab. Of note that
here are also a view mandatory names that are still needed for ClinSight
to function. It is not advised to delete these names. If they are
missing in your own data, just leave them in the metadata as is.</p>
<p><img src="images/metadata-general.png"></p>
</div>
<div class="section level4">
<h4 id="form_level_data">form_level_data<a class="anchor" aria-label="anchor" href="#form_level_data"></a>
</h4>
<p>This is an optional tab. If provided, the column
<code>item_group</code> is mandatory. In this tab, settings can be
adjusted on form level rather than setting them within the
<code>common_forms</code> or <code>study_forms</code> tab.</p>
<p><img src="images/metadata-form_level_data.png"></p>
<p>If a form is missing here, or one of the values
<code>item_scale</code>, <code>use_unscaled_limits</code>, or
<code>review_required</code> is not provided, then the defaults will be
used for that form:</p>
<table class="table">
<thead><tr class="header">
<th>item_scale</th>
<th>use_unscaled_limits</th>
<th>review_required</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>NA</code></td>
<td><code>NA</code></td>
<td><code>TRUE</code></td>
</tr></tbody>
</table>
<p><code>use_unscaled_limits</code> is a logical, which can be used to
control whether the limits of a continuous variable should be shown in
raw format. Not that setting this to TRUE will show all limits in the
data. This can be done if only one upper and lower limit is available
per variable in the data. See <a href="#metadata-study_forms">study_forms</a> for more information.</p>
<p><code>item_scale</code> can be used to control whether laboratory
values should be scaled so that they can be compared even if the units
and limits per study site differ. See <a href="#metadata-study_forms">study_forms</a> for more information.</p>
<p><code>review_required</code>: if FALSE, the variables in that form
will not show up as needed to review, and a review for that form cannot
be saved. Useful if the form provides background information that does
not require extensive review by the medical monitor.</p>
</div>
<div class="section level4">
<h4 id="table_names">table_names<a class="anchor" aria-label="anchor" href="#table_names"></a>
</h4>
<p>Can be used to get nicer names in the interactive tables in
ClinSight. Current table contains mostly standard ClinSight names, but
also other variable names could be included here.</p>
<p><img src="images/metadata-table_names.png"></p>
</div>
<div class="section level4">
<h4 id="settings">settings<a class="anchor" aria-label="anchor" href="#settings"></a>
</h4>
<p>The <code>settings</code> tab contains several options customizing
<code>ClinSight</code> data. Currently, the following settings are
available:</p>
<ol style="list-style-type: decimal">
<li>Settings for adjusting and customizing study data when merging with
metadata using [merge_meta_with_data()], by using custom functions in
the process. If a custom function name is added here, the function will
run at the described moment of the merging process (before or after
merging or data pivoting):
<ul>
<li><code>pre_merge_fns</code></li>
<li><code>pre_pivot_fns</code></li>
<li><code>post_pivot_fns</code></li>
<li><code>post_merge_fns</code></li>
</ul>
</li>
<li>Other (misc.) settings:
<ul>
<li>
<code>treatment_label</code> to set the label for the treatments in
the interactive timeline. Defaults to “💊 Tₓ”.</li>
</ul>
</li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leonard Daniël Samson, GCP-Service International Ltd.&amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
